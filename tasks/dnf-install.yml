---

# install postgres into redhat and its children distros (CentOS, Rocky, Oracle)
- name: upgrade minor system version before install postgres
  ansible.builtin.dnf:
    name: '*'
    state: latest
  
- name: install repo
  ansible.builtin.dnf:
    name: https://download.postgresql.org/pub/repos/yum/reporpms/EL-8-x86_64/pgdg-redhat-repo-latest.noarch.rpm
    state: present

- name: disable built-in postgresql set of packages
  ansible.builtin.command: dnf -qy module disable postgresql

- name: install postgres
  ansible.builtin.dnf:
    name: "{{ postgres_yum_packages }}"
    state: present

